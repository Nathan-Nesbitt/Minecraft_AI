<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta http-equiv="Content-Security-Policy" />
    <!--This sets width to device wotdh -->
    <meta name="viewport" content="width = device-width , initial-scale=1">
    
	<title>Minecraft AI - Code</title>
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <!-- Load bootstrap locally  -->
    <link rel="stylesheet" type="text/css" href="../static/css/bootstrap-3.3.7-dist/css/bootstrap.min.css">
    <script type="text/JavaScript" src="../static/css/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
    <!-- Link to persona CSS -->
    <link rel="stylesheet" href="./static/css/general_styling.css">
    
</head>

<body>
    <!-- use md for desktop grid system is 12-->
    <div class="container">
        <div class="row">
            <div class="col-md-12 title">
                <a href="../"> <img src="../static/includes/homebutton.png" id="homebtn" alt="Home"> </a>
                <input type="image" src="../static/includes/Question_mark.png"  
                id="questionmrk" data-toggle="popover" 
                title="Lesson Help" data-placement="bottom" 
                data-content="Press next to continue the lesson." />
                <div id="lesson_title">Code </div>
            </div>
        </div>
    </div>
    
    <div class="container pad">
        <!-- <div class="container maincont">
            <div class="row"> 
                <div class="col-md-2">

                    <div class="row text-center">
                        THIS BUTTON INSERTS INTO CODE CONSOLE(FILLS IN) 
                        <button id="buttonCode" class="button">Code</button>
                    </div>
                </div>
                <div class="col-md-10 hiegthforcode edit-text general" id="codeborder">  
                    <p></p>
                    <div id="containerMona" class="code codecimp"></div>
                </div>
            </div>
        </div> -->
        <div class="container maincont">
            <div class="row"> 
                <div class="col-md-12 hiegthforcode edit-text general" id="codeborder">  
                    <p></p>
                    <div id="containerMona" class="code codec"></div>
                </div>
            </div>
        </div>
    
         <div class="container">
            <div class="row">
                <button class="button" id="run"> Run </button>
                <button class="button" id="nextbutton">Next</button>
                <button class="button" id="previousbutton">Previous</button>
            </div>
        </div>
        
        <div class="container">
            <div class="wide general">
                 <div id="output-div">
                     <h1>Output</h1>
                     <div id="console" class="code outputborder">
                            <p id="output"></p>
                            <br>
                        </div>
                  </div>
                </div>
            </div>
        </div>
        <p></p>
        
    </div>
</body>
<script src="https://unpkg.com/monaco-editor@latest/min/vs/loader.js"></script>
<script type="module">
    import {EventHandler, Command, MinecraftLearns, DataStore, MinecraftAPIClient} from 'https://nathan-nesbitt.github.io/Minecraft_API/src/minecraft_api.js';
    window.EventHandler = EventHandler
    window.Command = Command
    window.MinecraftLearns = MinecraftLearns
    window.DataStore = DataStore
    window.MinecraftAPIClient = MinecraftAPIClient

</script>
<script>
    window.lesson = {
        "Step 1": {
            code: `// Create connection to game and back end //
var minecraft_api = new MinecraftAPIClient();\n`,
            text: "First we create a connection to the game.\nClick NEXT to see the next step"
        },
        "Step 2": {
            code: `var args = {
    connection: minecraft_api, 
    file_name: "block_broken.csv", 
    model_type: "decision_tree_regression", 
    response_variables: ["FeetPosY", "Biome"],
    features: ["Block"]
}\n
var minecraft_learns = new MinecraftLearns(args);\n`,
            text: "Then we create a new model.\nClick NEXT to see the next step"
        },
        "Step 3": {
            code: `// Create a callback function that makes a prediction based on the game data //
var callback_function_3 = function(data) {
    minecraft_learns.predict(data, ["diamond_ore"])
    .then(
        result => {
            // Then use the response to tell the user where to do in the game //
            new Command(minecraft_api, "Say", ["to mine this resource go to Y:", result.body.prediction.FeetPosY]);
        }            
    )
}\n`,
            text: "We determine what we want to predict and what to do when we have the prediction.\nClick NEXT to see the next step"
        },
        "Step 4": {
            code: `// Function that cleans the data, then trains it on the previously defined params //
minecraft_learns.process_data()
\t.then(minecraft_learns.train())
\t.then(() => {
    \t// Then we create an event handler for the game event //
    \tnew EventHandler(minecraft_api, "PlayerTravelled", callback_function_3)
\t})\n`,
            text: "We need to process the data and train the model before we predict.\nClick \"RUN\" to execute the model"
        },
    }
    // This sets all of the values for the lesson if it is defined
    if(localStorage["lesson"]) {
        var lesson = JSON.parse(localStorage["lesson"])
        document.getElementById("lesson_title").innerHTML += "- " + lesson.title;
        window.lesson = lesson.steps
    }
</script>
<script src="/static/setup/setup_monaco.js"></script>
<script src="/static/setup/setup_buttons.js"></script>
</html>